<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Design Iteration - Stilts</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/lines.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Stilts</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/Atrociously/stilts" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="design-iteration"><a class="header" href="#design-iteration">Design Iteration</a></h1>
<p>Design iteration is an important part of the design process. Friction in that process often
causes users to move on to other projects. This section will cover a few methods of reducing
development iteration time friction caused by Stilts.</p>
<p>This friction is unfortunately fundamental to how Stilts operates as an engine. The compile
time guarantees are provided by the rust compiler, meaning that whatever crate contains templates
must recompile when templates change.</p>
<p>The techniques for reducing this friction can be broadly categorized into 3 groups:
Live Reload, Change Watching, and Compilation Speed.</p>
<h2 id="live-reload"><a class="header" href="#live-reload">Live Reload</a></h2>
<hr />
<p>A method of automatically refreshing changes on the frontend of a design for the designer to view when
changes are made to a code base. When using Stilts this methodology works much better when combined with a change watcher.</p>
<ul>
<li><a href="https://github.com/leotaku/tower-livereload">Tower Livereload</a> is a library which can be added to any web server that
makes use of the <a href="https://docs.rs/tower/latest/tower/">tower</a> ecosystem. It injects code to automatically refresh the
browser when it detects the server go down and come back.</li>
</ul>
<h2 id="change-watching"><a class="header" href="#change-watching">Change Watching</a></h2>
<hr />
<p>A system that watches for file changes inside your project and automatically causes a recompilation
based on that.</p>
<ul>
<li>
<p><a href="https://github.com/Canop/bacon">Bacon</a> is a wonderful tool which watches for rust source code file changes. This requires
some configuration to use in conjunction with Stilts. Namely, bacon must be told to also watch the <code>templates</code> directory,
and to kill the running process and restart instead of wait and restart.</p>
<p>You can configure this in a global config or at the project level in a file called <code>bacon.toml</code> but here is an example
config that works for Stilts.</p>
<pre><code class="language-toml">[jobs.watch]
command = ["cargo", "run"]
on_change_strategy = "kill_then_restart"
watch = ["templates/"]
</code></pre>
<p>Then all you have to do is run <code>bacon watch</code> and code changes will automatically result in a recompilation and rerun.</p>
</li>
<li>
<p><a href="https://github.com/watchexec/watchexec">Watchexec</a> is a great and fairly simple tool which watches files and runs a command
when it detects changes. It can be used without configuration with a simple single command.</p>
<pre><code class="language-shell">watchexec -r -e rs,html,css,js cargo run
</code></pre>
<p>Will watch for changes in files with the extensions: rs, HTML, CSS, or JS and run the command <code>cargo run</code> while
restarting the existing process that was already running.</p>
</li>
<li>
<p><a href="https://github.com/watchexec/cargo-watch">Cargo Watch</a> Is not recommended by the project author anymore due to lack of
time to support the project, however it still works very well. It is the most straightforward to use as a single simple command
with no special flags works out of the box for Stilts projects.</p>
<pre><code class="language-shell">cargo watch
</code></pre>
</li>
</ul>
<h2 id="compiliation-speed"><a class="header" href="#compiliation-speed">Compiliation Speed</a></h2>
<p>Stilts requires a full recompilation of your source code anytime a change is made to your templates. This means that reducing
compilation times will increase the speed with which you can iterate on your designs. There are multiple methods of doing this
and many of them can be combined to add on top of eachother.</p>
<ul>
<li><strong>Break you code up into multiple crates.</strong> One simple performance improvement can be to break code into multiple crates. There isn't
an exact science to this, and it may not be a good idea for very simple projects. The reason this works however is that the rust
compiler launches multiple threads to perform compilation in parallel, but the unit of compilation is the crate. Meaning that
splitting code into multiple crates makes for better parallel compilation.</li>
<li><strong>Use the <a href="https://github.com/rui314/mold">mold</a> linker.</strong> This is simply a tool switch from the default linker rust uses to another
which performs the same task but faster. Linking is the final step in compilation, and any performance increase is welcome.
The mold readme has a section on how to use it for rust.</li>
<li><strong>Use the <a href="https://github.com/rust-lang/rustc_codegen_cranelift">rustc cranelift backend</a>.</strong> This replaces another component in the
compilation process. This time it replaces the backend of the compiler which generates the low level objects that get linked together.
Rust uses LLVM by default but cranelift can sometimes be faster. The downside of this currently is that it requires using nightly rust.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="configuration.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="extension_traits.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="configuration.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="extension_traits.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="theme/highlightjs-line-numbers.min.js"></script>
        <script src="theme/linenum.js"></script>
        <script src="vis/plotly.min.js"></script>
        <script src="vis/boxit.js"></script>


    </div>
    </body>
</html>

# Template Syntax

A stilts template ultimatly gets its syntax from [Jinja](https://jinja.palletsprojects.com).
It uses `{%` and `%}` as its expression delimiters.

Here is how you can write the variable `my_variable` to a template:
```html
<div>
    {% my_variable %}
</div>
```

This differs from how Jinja and Askama handle this, they both have a
different set of delimiters to differentiate between **expressions** and
**tags**. Stilts adopts a more rust-centric approach, it differentiates
between [expressions](https://doc.rust-lang.org/reference/expressions.html) and 
[statements](https://doc.rust-lang.org/reference/statements.html).

It uses the difference between a rust expression and statement to determine
whether the contents of a stilts expression should be rendered or not.
Having two different kinds of expressions can be a little confusing.
To help aleviate that from now on I will refer to a delimited stilts
expression as an expr, and a rust expression as an expression.

- Expr: `{% my_variable %}` -- This is a stilts template expression
- Expression: `println!("Hello World")` -- This is a rust expression

To compare terms to Askama:

| Stilts          | Askama       |
|-----------------|--------------|
| text content    | text content |
| expr expression | expression   |
| expr statement  | tag          |
| expr tag        | tag          |

By the way if you have naming suggestions for this stuff let me know because I feel it might be confusing.

We haven't gone over an **expr tag** yet but those are stilts language constructs, things defined and
implemented by the templating language itself.
whereas **expr expression** and **expr statement** simply contain standard rust code.

So what does all that mean? It means stilts allows you to write any valid rust expression 
or statement between its delimiters.

```html
<div>
    {% let s = "Hello This Will Have No Spaces"; %}
    {% s.chars()
        .filter(|c| !c.is_whitespace())
        .collect::<String>() %}
</div>
```

In this example there is an expr with a statment inside followed by an expr with an expression
inside it. Stilts will use the fact that rust expressions always produce a value and statements
don't to know which of these to render. The first expr will be ran as regular rust code, and
the second will be rendered using [Display](https://doc.rust-lang.org/std/path/struct.Display.html).

There are no rules on how to format these delimiters you could write the same thing in multiple ways
that all come down to personal preference.

```html
<div>
    {% let s = "Hello This Will Have No Spaces"; %}
    {% 
    s.chars()
        .filter(|c| !c.is_whitespace())
        .collect::<String>()
    %}
</div>
```

I think looking at what code is generated by stilts can help understand what is going on under the hood.

```rust
// slightly simplified imports for readability
impl Template for MyTemplate {
    fn fmt(&self, _w: &mut (impl Write + ?Sized)) -> Result {
        // These are traits that help provide useful functions for rendering
        // like escaping html, writing as json, and using a types Debug implementation
        // instead of Display.
        use stilts::DisplayExt as _;
        use stilts::DebugExt as _;
        use stilts::SerializeExt as _;

        let Self { .. } = self; // destructure the struct fields

        _w.write_str("<div>\n   ")?;
        // Notice that the expr statement is just output as it was given as rust code
        let s = "Hello This Will Have No Spaces";
        // And then that an expr expression is written to the template writer
        // this is simplified for viewing here it actually also wraps the type in an stilts::escaping::Escaped struct
        write!(
            _w,
            "{}",
            s.chars()
                .filter(|c| !c.is_whitespace())
                .collect::<String>()
        )?;
        _w.write_str("</div>")?;
        Ok(())
    }
}
```

You may already be getting ideas about what this means for your templates. You can write
arbitrary rust code within your templates without much hassle.

This alone is not enough to write expressive template code however. You also need template
control structures to do useful things. This is what an **expr tag** is, and what the next
section will be covering.
